# Build an Android APK and upload it as a downloadable Actions artifact (no pushing to GitHub)
# Trigger: manual via "Run workflow" in Actions (workflow_dispatch)
name: Build APK

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    timeout-minutes: 60

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: '17'

      - name: Cache Gradle
        uses: actions/cache@v4
        with:
          path: |
            ~/.gradle/caches
            ~/.gradle/wrapper
          key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
          restore-keys: |
            ${{ runner.os }}-gradle-

      - name: Make gradlew executable
        run: chmod +x ./gradlew

      - name: Build APK (Debug)
        # Change to `assembleRelease` if you want a release build (ensure signing is configured)
        run: ./gradlew assembleDebug --no-daemon

      - name: Collect APK(s)
        run: |
          mkdir -p output-apks
          # find all .apk files produced by the build and copy them into output-apks preserving subdirs
          find . -type f -name "*.apk" -exec cp --parents {} output-apks/ \; || true
          echo "Collected APKs:"
          ls -R output-apks || true

      - name: Upload APKs as artifact
        uses: actions/upload-artifact@v4
        with:
          name: built-apks
          path: output-apks/
          retention-days: 7
``` ````

Notes and next steps:
- The workflow builds the debug APK by default (safe because it doesn't require signing). If you need a release-signed APK, replace `assembleDebug` with `assembleRelease` and configure signing keys (recommended via GitHub Secrets and a secure signing step).
- After the run completes, download the artifact from the Actions run page: click the run → "Artifacts" → `built-apks`.
- If your project uses product flavors or a different Gradle task, change the Gradle command accordingly (for example, `./gradlew assembleMyFlavorRelease`).
